<template>
  <div class="dashboard">
    <div class="header">
      <div class="menu">
        <ul>
          <li>Homepage</li>
          <li>Series</li>
          <li class="active">Movies</li>
        </ul>
      </div>
      <div class="logo">
        <svg width="130" height="35" viewBox="0 0 130 35" fill="none" xmlns="http://www.w3.org/2000/svg">
        <path d="M4.18493 9.96153C4.09589 9.96153 4.09589 9.96153 4.18493 9.96153C4.09589 17.859 4.09589 25.8461 4.09589 33.7436C2.67123 33.9231 1.33562 34.1026 0 34.3718C0 23.2436 0 12.0256 0 0.89743C1.86986 0.89743 3.82877 0.89743 5.69863 0.89743C7.21233 7.35897 8.72603 13.7308 10.2397 20.0128H10.3288C10.3288 13.641 10.3288 7.26923 10.3288 0.89743C11.6644 0.89743 13 0.89743 14.3356 0.89743C14.3356 11.3974 14.3356 21.8974 14.2466 32.3077C12.7329 32.4872 11.1301 32.6667 9.61644 32.9359C7.83562 25.4872 5.96575 17.7692 4.18493 9.96153Z" fill="#E50914"/>
        <path d="M23.774 13.7308C25.822 13.641 27.9589 13.5513 30.0069 13.4615C30.0069 14.8974 30.0069 16.3333 30.0069 17.6795C27.9589 17.7692 25.822 17.859 23.774 18.0385C23.774 21 23.774 23.9615 23.774 26.9231C26.3562 26.7436 29.0274 26.4744 31.6096 26.2949C31.6096 27.7308 31.6096 29.0769 31.6096 30.5128C27.5137 30.8718 23.3288 31.2308 19.2329 31.6795C19.2329 21.359 19.322 11.1282 19.322 0.807693C23.4178 0.807693 27.6028 0.807693 31.6987 0.807693C31.6987 2.24359 31.6987 3.58975 31.6987 5.02564C29.1165 5.02564 26.4452 5.11539 23.863 5.11539C23.863 8.07692 23.863 10.859 23.774 13.7308Z" fill="#E50914"/>
        <path fill-rule="evenodd" clip-rule="evenodd" d="M45.579 29.6782L45.589 29.7051C47.1027 29.6154 48.7055 29.5256 50.3082 29.6154C49.774 28.5385 49.774 27.4615 49.774 26.1154V21.718C49.774 18.6667 48.9726 16.6026 46.7466 15.7051V15.6154C48.7055 14.6282 49.6849 12.7436 49.6849 9.78205V7.53846C49.6849 3.14103 47.726 0.987183 43.0069 0.987183H36.1507C36.1507 5.87821 36.1284 10.7692 36.1062 15.6603C36.0839 20.5513 36.0616 25.4423 36.0616 30.3333L40.6027 30.0641V18.218C41.137 18.1282 41.6712 18.1282 42.2055 18.1282C44.2534 18.0385 45.1438 19.0256 45.1438 21.718V26.2051C45.1438 28.5092 45.3175 28.9756 45.579 29.6782ZM40.6918 13.9103V5.02564C41.4041 5.02564 42.1164 5.02564 42.9178 4.84616C44.5205 4.84616 45.2329 5.74359 45.2329 7.8077V10.6795C45.2329 13.0128 44.1644 13.8205 42.4726 13.8205C41.8493 13.9103 41.3151 13.9103 40.6918 13.9103Z" fill="#E50914"/>
        <path fill-rule="evenodd" clip-rule="evenodd" d="M61.6164 0.89743H54.4041V29.3461C55.6061 29.3461 56.8082 29.3237 58.0102 29.3013C59.2123 29.2788 60.4143 29.2564 61.6164 29.2564C66.1575 29.2564 68.3835 26.8333 68.3835 22.2564V7.89743C68.3835 3.41025 66.1575 0.89743 61.6164 0.89743ZM58.9451 25.2179V4.93589H61.5273C62.952 4.93589 63.8424 5.65384 63.8424 7.71794V22.4359C63.8424 24.5 62.952 25.2179 61.5273 25.2179H58.9451Z" fill="#E50914"/>
        <path d="M77.3767 13.5513C79.3356 13.5513 81.2945 13.641 83.2534 13.641C83.2534 14.9872 83.2534 16.4231 83.2534 17.7692C81.2945 17.6795 79.3356 17.6795 77.3767 17.6795C77.3767 21.6282 77.3767 25.5769 77.3767 29.4359C75.863 29.3461 74.3493 29.3461 72.8356 29.3461C72.8356 19.8333 72.8356 10.4103 72.8356 0.89743C76.8424 0.89743 80.8493 0.89743 84.8561 0.89743C84.8561 2.24358 84.8561 3.67948 84.8561 5.02564C82.363 5.02564 79.8698 5.02564 77.3767 5.02564C77.3767 7.80769 77.3767 10.6795 77.3767 13.5513Z" fill="#E50914"/>
        <path d="M88.6849 0.89743C90.1986 0.89743 91.7123 0.89743 93.226 0.89743C93.226 9.24358 93.226 17.6795 93.3151 26.0256C95.8082 26.2051 98.3014 26.3846 100.795 26.5641C100.795 28 100.795 29.4359 100.795 30.8718C96.7877 30.5128 92.7808 30.2436 88.774 29.9744C88.774 20.282 88.6849 10.5897 88.6849 0.89743Z" fill="#E50914"/>
        <path d="M104.356 0.89743C105.87 0.89743 107.384 0.89743 108.897 0.89743C108.897 11.1282 108.986 21.359 108.986 31.5897C107.473 31.4103 105.959 31.2308 104.445 31.141C104.356 21.0897 104.356 10.9487 104.356 0.89743Z" fill="#E50914"/>
        <path d="M128.931 0.897437C127.329 6.28205 125.815 11.5769 124.212 16.7821C125.904 22.5256 127.596 28.359 129.288 34.3718C127.685 34.1026 126.082 33.8333 124.568 33.6538C123.322 29.1667 122.164 24.7692 120.918 20.3718H120.829C119.582 24.5 118.336 28.6282 117.178 32.5769C115.753 32.3974 114.329 32.218 112.904 32.0385C114.596 26.9231 116.288 21.6282 117.979 16.3333C116.377 11.0385 114.774 5.92308 113.171 0.897437C114.774 0.897437 116.288 0.897437 117.89 0.897437C119.048 4.84615 120.116 8.79487 121.274 12.7436H121.363C122.52 8.79487 123.678 4.84616 124.836 0.807693C126.171 0.897437 127.596 0.897437 128.931 0.897437Z" fill="#E50914"/>
        </svg>
      </div>
      <div class="rating_count">
        <span><svg width="18" height="19" viewBox="0 0 18 19" fill="none" xmlns="http://www.w3.org/2000/svg">
        <path fill-rule="evenodd" clip-rule="evenodd" d="M8.99997 15.3311L3.97602 17.9464C3.60892 18.1375 3.18185 17.8253 3.25248 17.4175L4.21069 11.8856L0.15621 7.97222C-0.143023 7.6834 0.0205978 7.17679 0.432239 7.11756L6.04003 6.31069L8.55247 1.26989C8.73653 0.900607 9.26341 0.900607 9.44746 1.26989L11.9599 6.31069L17.5677 7.11756C17.9793 7.17679 18.143 7.6834 17.8437 7.97222L13.7892 11.8856L14.7475 17.4175C14.8181 17.8253 14.391 18.1375 14.0239 17.9464L8.99997 15.3311Z" fill="#F8E71C"/>
        </svg> 5</span>
      </div>
    </div>

    <div class="title">
        <h1>Movies</h1>
    </div>

    <div class="filters">
      <div class="search">
        <input type="text" v-model="searchValue" placeholder="Search for a title" id="search_movie">
      </div>

      <div class="sort">
        <select v-model="selectedSort">
          <option value="asc" selected>Title (A-Z)</option>
          <option value="desc">Title (Z-A)</option>
        </select>
        <select class="selectedRating" v-model="selectedRating">
          <option value="Rating">Rating</option>
          <option value="1">1</option>
          <option value="2">2</option>
          <option value="3">3</option>
          <option value="4">4</option>
          <option value="5">5</option>
          <option value="6">6</option>
          <option value="7">7</option>
          <option value="8">8</option>
          <option value="9">9</option>
          <option value="10">10</option>
        </select>
      </div>
    </div>

    <div class="movies">
      <div v-for="movie in filteredMovies" :key="movie.title">
        <MovieCard :movie="movie" />
      </div>
    </div>
  </div>
</template>

<script>
import MovieCard from './MovieCard.vue'

export default {
  name: 'MovieDashboard',
  components: {
    MovieCard
  },
  props: {
    movies: JSON
  },
  data() {
    return {
      searchValue: '',
      selectedSort: 'asc',
      selectedRating: 'Rating'
    }
  },
  computed: {
    filteredMovies() {
      let sortedMovies = this.movies

      if(this.searchValue != '' && this.searchValue) {
        sortedMovies = sortedMovies.filter((movie) => {
          return movie.title.toUpperCase().includes(this.searchValue.toUpperCase())
        }) 
      }

      sortedMovies = sortedMovies.sort((a, b) => {
        if(this.selectedSort == 'asc') {
          let fa = a.title.toLowerCase(), fb = b.title.toLowerCase()
          if (fa < fb) {
            return -1
          }
          if (fa > fb) {
            return 1 
          }
          return 0
        } else {
          let fa = a.title.toLowerCase(), fb = b.title.toLowerCase()
          if (fa < fb) {
            return 1
          }
          if (fa > fb) {
            return -1 
          }
          return 0
        }
      })

      if(this.selectedRating != 'Rating') {
        sortedMovies = sortedMovies.filter((movie) => {
          return Math.floor(movie.rating) == this.selectedRating
        })
      }

      return sortedMovies
    }
  }
}
</script>

<style scoped>
  .header {
    background: #131313;
    height: 75px;
    line-height: 75px;
    display: flex;
    justify-content: space-between;
  }

  .header ul {
    margin: 0;
    padding: 0;
    height: 75px;
    display: flex;
  }

  .header li {
    display: inline;
    font-size: 16px;
    margin-left: 50px;
    height: 75px;
  }

  .header .rating_count {
    margin-right: 50px;
  }

  .header .logo {
    color: #E50914;
    display: flex;
    flex-direction: column;
    justify-content: center;
  }

  .active {
    box-sizing: border-box;
    border-bottom: 4px solid #E50914;
  }

  .title {
    background: #171717;
    height: 122px;
  }

  .title h1 {
    padding-left: 50px;
    font-size: 36px;
    margin: 0px;
    line-height: 122px;
  }

  .movies {
    margin: 80px 50px;
    display: flex;
    flex-wrap: wrap;
  }

  .filters {
    margin: 0 50px;
    display: flex;
    justify-content: space-between;
  }

  input, select {
    color: #FFF;
    background: #131313;
    border: 1px solid #2E2E2E;
    box-sizing: border-box;
    border-radius: 6px;
    padding: 10px;
  }

  .selectedRating {
    margin-left: 5px;
  }
</style>
